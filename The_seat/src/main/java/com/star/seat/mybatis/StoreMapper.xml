<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="store">
	<!-- 매장 추가 method -->
	<insert id="addStore" parameterType="string">
		insert into store
		(num, owner, storeName, storeAddr, openingTime,
			storeOpen, regdate)
		values(store_seq.nextval, #{email}, 'Default Name', 'Default Address', '00:00 ~ 24:00',
			'no', sysdate)
	</insert>
	
	<!-- 사장님의 매장 정보 목록 가져오는 method -->
	<select id="getMyStores" parameterType="string" resultType="storeDto">
		select *
		from store
		where owner=#{email}
	</select>
	
	<!-- 사장님의 매장 정보 하나만 가져오는 method(이메일과 rnum 이용) -->
	<select id="getMyStore" parameterType="storeDto" resultType="storeDto">
		select *
		from
			(select result1.*, rownum as rnum
			from
				(select *
				from store
				where owner=#{owner}) result1)
		where rnum=#{num}
	</select>
	
	<!-- 사장님의 매장 정보 하나만 가져오는 method(해당 매장 DB 번호 이용) -->
	<select id="getMyStore_num" parameterType="storeDto" resultType="storeDto">
		select *
		from store
		where num=#{num}
	</select>

	<!-- 검색한 매장 목록들 불러오는 method -->
	<select id="getList" parameterType="storeDto" resultType="storeDto">
		select *
		from store
	</select>
	
	<!-- 매장 태그를 추가하는 method -->
	<update id="addTag">
		update store
		set storeTag=#{storeTag}
		where num=#{num}
	</update>
</mapper>
